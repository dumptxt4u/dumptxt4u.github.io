<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MathML JSON Quiz</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:24px;background:#f6f8fa}
    .card{background:#fff;border-radius:12px;padding:20px;box-shadow:0 6px 18px rgba(20,20,30,0.06);max-width:880px;margin:12px auto}
    .q-meta{color:#666;font-size:14px;margin-bottom:8px}
    .question{font-size:20px;margin:12px 0}
    .options{list-style:none;padding:0}
    .options li{margin:8px 0}
    button{padding:8px 12px;border-radius:8px;border:0;background:#0b79ff;color:#fff;cursor:pointer}
    button.secondary{background:#6b7280}
    .score{font-weight:700}
    .controls{display:flex;gap:8px;margin-top:14px}
  </style>
  <!-- MathJax v3 with both TeX and MathML support -->
  <script>
    window.MathJax = {
      loader: {load: ['input/mml','input/tex','output/chtml']},
      tex: {inlineMath: [['$','$'], ['\\(','\\)']]},
      options: {skipHtmlTags: ['script','noscript','style','textarea','pre']}
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
</head>
<body>
  <div class="card" id="app">
    <div class="q-meta" id="meta">Question <span id="index">1</span> / <span id="total">0</span></div>
    <div class="question" id="question">Loading...</div>

    <ul class="options" id="options"></ul>

    <div class="controls">
      <button id="prev" class="secondary">◀ Prev</button>
      <button id="next" class="secondary">Next ▶</button>
      <button id="submit">Submit Answer</button>
      <div style="margin-left:auto">Score: <span class="score" id="score">0</span></div>
    </div>

    <div style="margin-top:12px;color:#444" id="feedback"></div>
  </div>

  <script>
    // Sample JSON. Replace or load this object from an external file as required.
    const mcq_array = [
      {
        "q_latex": "Let $R$ be a relation on the set $N$ given by $R=\\{(a, b): a=b-2, b>6\\}$. Then,\\",
        "q_mathml": "<math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><mrow><mi>R</mi><mo>=</mo><mo>{</mo><mrow><mo>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo>)</mo><mo>:</mo><mi>a</mi><mo>=</mo><mi>b</mi><mo>-</mo><mn>2</mn><mo>,</mo><mi>b</mi><mo>&gt;</mo><mn>6</mn></mrow><mo>}</mo></mrow></math>",
        "options": [
          {"label":"(a)", "text_mathml":"<math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"inline\"><mrow><mi>R</mi><mo>=</mo><mo>\{</mo><mrow><mo>(</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo>)</mo></mrow><mo>\}</mo></mrow></math>", "correct": false},
          {"label":"(b)", "text_mathml":"<math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"inline\"><mrow><mi>R</mi><mo>=</mo><mo>\{</mo><mrow><mo>(</mo><mn>4</mn><mo>,</mo><mn>6</mn><mo>)</mo></mrow><mo>\}</mo></mrow></math>", "correct": false},
          {"label":"(c)", "text_mathml":"<span>All pairs of the form <math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"inline\"><mrow><mi>(</mi><mi>b-2</mi><mo>,</mo><mi>b</mi><mo>)</mo></mrow></math> with <math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"inline\"><mrow><mi>b</mi><mo>&gt;</mo><mn>6</mn></mrow></math></span>", "correct": true},
          {"label":"(d)", "text":"No such relation exists.", "correct": false}
        ]
      },
      {
        "q_latex": "If P(E)=0.3 and P(E \u222a F)=0.5 and E and F are independent, find P(F).",
        "q_mathml": "",
        "options": [
          {"label":"(a)", "text":"0.2", "correct": true},
          {"label":"(b)", "text":"0.15", "correct": false},
          {"label":"(c)", "text":"0.5", "correct": false},
          {"label":"(d)", "text":"0.35", "correct": false}
        ]
      },
      {
  "q_latex": "Let $R$ be a relation on the set $N$ given by $R=\\{(a, b): a=b-2, b>6\\}$. Then,",
  "q_mathml": "",
  "options": [
    {"label":"(a)", "text":"$(2,4) \\in R$", "correct": false},
    {"label":"(b)", "text":"$(3,8) \\in R$", "correct": false},
    {"label":"(c)", "text":"$(6,8) \\in R$", "correct": true},
    {"label":"(d)", "text":"$(8,7) \\in R$", "correct": false}
  ]
}
    ];

    // State
    let idx = 0;
    const total = mcq_array.length;
    const userAnswers = Array(total).fill(null);
    let score = 0;

    document.getElementById('total').textContent = total;
    document.getElementById('score').textContent = score;

    function renderQuestion(i){
      const q = mcq_array[i];
      document.getElementById('index').textContent = i+1;

      // prefer MathML if present, otherwise show LaTeX (rendered by MathJax)
      const qContainer = document.getElementById('question');
      if(q.q_mathml && q.q_mathml.trim()){
        qContainer.innerHTML = q.q_mathml;
      } else if(q.q_latex){
        qContainer.innerHTML = q.q_latex;
      } else {
        qContainer.textContent = 'No question text provided.';
      }

      const opts = document.getElementById('options');
      opts.innerHTML = '';
      q.options.forEach((opt, k)=>{
        const li = document.createElement('li');
        const id = `opt-${i}-${k}`;
        const input = document.createElement('input');
        input.type = 'radio'; input.name = 'option'; input.id = id; input.value = k;
        if(userAnswers[i]===k) input.checked = true;
        const label = document.createElement('label');
        label.htmlFor = id;

        // option text may be mathml, latex, or plain text
        if(opt.text_mathml){
          label.innerHTML = `${opt.label} ` + opt.text_mathml;
        } else if(opt.text_latex){
          label.innerHTML = `${opt.label} $${opt.text_latex}$`;
        } else {
          label.textContent = `${opt.label} ${opt.text}`;
        }

        li.appendChild(input); li.appendChild(label);
        opts.appendChild(li);
      });

      // typeset math in newly inserted content
      if(window.MathJax && MathJax.typesetPromise){
        MathJax.typesetClear();
        MathJax.typesetPromise();
      }

      document.getElementById('feedback').textContent = '';
    }

    function submitAnswer(){
      const selected = document.querySelector('input[name="option"]:checked');
      if(!selected){
        document.getElementById('feedback').textContent = 'Please select an option.';
        return;
      }
      const ans = parseInt(selected.value,10);
      userAnswers[idx] = ans;
      const correctness = !!mcq_array[idx].options[ans].correct;
      document.getElementById('feedback').textContent = correctness ? 'Correct ✅' : 'Incorrect ❌';

      // update score: count correct answers
      score = userAnswers.reduce((acc, v, i) => acc + (v !== null && mcq_array[i].options[v].correct ? 1 : 0), 0);
      document.getElementById('score').textContent = score;
    }

    document.getElementById('next').addEventListener('click', ()=>{
      if(idx < total-1){ idx++; renderQuestion(idx); }
    });
    document.getElementById('prev').addEventListener('click', ()=>{
      if(idx > 0){ idx--; renderQuestion(idx); }
    });
    document.getElementById('submit').addEventListener('click', submitAnswer);

    // initialize
    renderQuestion(idx);

    // Optional: expose functions for external use (load JSON dynamically)
    window.loadQuizFromJSON = function(json){
      if(!Array.isArray(json)) throw new Error('Expected an array');
      mcq_array.length = 0; mcq_array.push(...json);
      idx = 0; score = 0; userAnswers.length = mcq_array.length; userAnswers.fill(null);
      document.getElementById('total').textContent = mcq_array.length;
      renderQuestion(0);
    };
  </script>
</body>
</html>
